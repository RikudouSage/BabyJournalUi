<mat-spinner class="global" *ngIf="loading; else content"></mat-spinner>

<ng-template #content>
  <form [formGroup]="form">
    <mat-card>
      <mat-card-content>
        <mat-error class="center" *ngIf="errorMessage | async; let message">
          {{message}}
        </mat-error>
        <mat-form-field>
          <mat-label>{{'Start time' | translate}}</mat-label>
          <input matInput formControlName="startTime" [mtxDatetimepicker]="startTime" required />
          <mtx-datetimepicker-toggle matIconSuffix [for]="startTime"></mtx-datetimepicker-toggle>
          <mtx-datetimepicker #startTime [touchUi]="isHandset | async" startView="clock"></mtx-datetimepicker>
        </mat-form-field>
        <mat-form-field>
          <mat-label>{{'End time' | translate}}</mat-label>
          <input matInput formControlName="endTime" [mtxDatetimepicker]="endTime" required />
          <mtx-datetimepicker-toggle matIconSuffix [for]="endTime"></mtx-datetimepicker-toggle>
          <mtx-datetimepicker #endTime [touchUi]="isHandset | async" startView="clock"></mtx-datetimepicker>
        </mat-form-field>
      </mat-card-content>
      <mat-form-field>
        <mat-label>{{'Note' | translate}}</mat-label>
        <textarea matInput formControlName="note"></textarea>
      </mat-form-field>
      <!-- Bottle -->
      <ng-container *ngIf="form.controls.type.value === 'bottle'">
        <mat-form-field>
          <mat-label>{{'Amount' | translate}} (ml)</mat-label>
          <input matInput formControlName="amount" type="number" inputmode="numeric" required />
        </mat-form-field>
        <mat-form-field>
          <mat-label>{{'Content' | translate}}</mat-label>
          <mat-select formControlName="bottleContentType" required>
            <mat-option [value]="BottleContentType.BreastMilk">
              {{bottleContentTypeToString(BottleContentType.BreastMilk) | async | uppercaseFirst}}
            </mat-option>
            <mat-option [value]="BottleContentType.Formula">
              {{bottleContentTypeToString(BottleContentType.Formula) | async | uppercaseFirst}}
            </mat-option>
            <mat-option [value]="BottleContentType.Water">
              {{bottleContentTypeToString(BottleContentType.Water) | async | uppercaseFirst}}
            </mat-option>
            <mat-option [value]="BottleContentType.Juice">
              {{bottleContentTypeToString(BottleContentType.Juice) | async | uppercaseFirst}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>
      <ng-container *ngIf="form.controls.type.value === 'nursing'">
        <mat-form-field>
          <mat-label>{{'Breast' | translate}}</mat-label>
          <mat-select formControlName="breast">
            <mat-option [value]="BreastIndex.Left">
              {{breastIndexToString(BreastIndex.Left) | async | uppercaseFirst}}
            </mat-option>
            <mat-option [value]="BreastIndex.Right">
              {{breastIndexToString(BreastIndex.Right) | async | uppercaseFirst}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>
    </mat-card>
    <a class="right-corner-fab" mat-fab color="primary" (click)="save()">
      <mat-icon>save</mat-icon>
    </a>
  </form>
</ng-template>
